# 1 输入一个网址会发生什么

输入一个网址后，会发生以下步骤：

1. 解析URL：浏览器首先会对URL进行解析，分析所需要使用的传输协议（如http或https）和请求的资源的路径。
2. DNS解析：浏览器将解析出的域名发送给DNS服务器，以获取对应的IP地址。DNS服务器的作用是将域名转换为相应的IP地址。
3. 建立TCP连接：一旦浏览器获取到目标网站的IP地址，它会使用TCP（传输控制协议）与服务器建立连接。TCP是一种用于在网络上建立可靠连接的协议。
4. 发起HTTP请求：一旦建立了TCP连接，浏览器将向服务器发送一个HTTP（超文本传输协议）请求。这个请求包括所访问网页的详细信息，如请求的方式（GET或POST）、请求头（附加信息，例如浏览器版本）以及请求体（如果有需要发送数据的话）。
5. 服务器处理请求：服务器接收到浏览器发送的请求后，会对请求进行处理。处理的方式取决于网站的后台代码，通常包括从数据库中获取数据、执行应用逻辑等。
6. 服务器发送响应：一旦服务器完成了请求处理，它会生成一个HTTP响应并发送回给浏览器。响应包括响应头（例如状态码、响应时间等）和响应体（实际的网页内容）。
7. 接收和渲染网页：浏览器接收到服务器的响应后，会解析响应，并根据相应的HTML、CSS和JavaScript等资源来渲染网页。浏览器将处理和执行这些资源，以展示最终的网页内容。
8. 断开TCP连接：一旦网页渲染完成，浏览器会关闭与服务器之间的TCP连接。这意味着服务器和浏览器之间的通信结束了。

# 2 什么是三次握手和四次挥手

三次握手和四次挥手是TCP协议中用来建立和终止TCP连接的过程。

三次握手是建立一个TCP连接的过程，需要经过以下三个步骤：

1. 客户端发送连接请求报文段，请求建立连接，SYN=1，ACK=0。
2. 服务器收到请求并发送确认报文段，表示同意建立连接，SYN=1，ACK=1。
3. 客户端收到确认并发送确认报文段，表示连接已经建立，ACK=1。

四次挥手是终止一个TCP连接的过程，需要经过以下四个步骤：

1. 客户端发送终止请求报文段，请求关闭连接，FIN=1，ACK=0。
2. 服务器收到请求并发送确认报文段，表示同意关闭连接，FIN=1，ACK=1。
3. 客户端收到确认并发送确认报文段，表示已经收到服务器的关闭请求，ACK=1。
4. 服务器收到确认并终止连接。

## 2.1 为什么要三次握手

TCP协议采用三次握手的主要原因是为了确保可靠的连接建立，同时解决了网络中可能存在的一些问题。以下是三次握手的主要原因：

1. 确认双方的通信能力：在进行数据传输之前，双方需要确认彼此的通信能力。客户端发起连接请求，服务器回应确认，再由客户端发送确认，这样可以确保双方的通信能力正常。
2. 避免旧连接的延迟影响：如果只有两次握手，客户端发送连接请求，但该请求在网络中被延迟，可能由于网络拥塞或其他原因导致延迟。此时，客户端可能会认为连接已建立，但服务器并不知情。当客户端再次发送数据时，服务器可能会拒绝或丢弃这些数据，因为它并没有建立有效的连接。通过引入第三次握手，可以避免旧连接的影响，确保客户端和服务器都知道连接已成功建立。
3. 防止重复连接：三次握手可以防止旧的重复连接引起连接混乱问题，例如在网络状况比较复杂或者网络状况比较差的情况下，发送方可能会连续发送多次建立连接的请求。如果TCP握手的次数只有两次，那么接收方只能选择接受请求或者拒绝接受请求，但它并不清楚这次的请求是正常的请求，还是由于网络环境问题而导致的过期请求，如果是过期请求的话就会造成错误的连接。
4. 同步初始化序列化：TCP的一个重要特征就是可靠性，而TCP为了保证在不稳定的网络环境中构建一个稳定的数据连接，它就需要一个“序列号”字段来保证自己的稳定性，而这个序列号的作用就是防止数据包重复发送，以及有效的解决数据包接收时顺序颠倒的问题。

综上所述，TCP协议采用三次握手是为了确保可靠的连接建立、避免旧连接的延迟影响、防止重复连接以及同步初始化序列化。

## 2.2 TCP三次握手中，最后一次回复丢失，会发生什么

TCP三次握手过程中，如果最后一次握手（ACK报文）丢失，服务器将无法收到客户端的确认，导致服务器无法正常关闭连接。这种情况下，服务器会一直处于SYN_RECV状态，等待客户端再次发送请求。如果服务器等待时间过长仍未收到客户端的请求，服务器将会断开连接。因此，为了保证TCP连接的正常关闭，需要确保三次握手过程中的每一次握手都得到正确的响应。

# 3 http状态码分类

HTTP状态码分为五大类，分别是：

1. 1xx 信息性状态码：表示接收的请求正在处理，这类状态码用于提供关于请求的一些信息性响应，而不是指示成功或失败。常见的1xx状态码包括100 Continue和101 Switching Protocols。
2. 2xx 成功状态码：表示请求正常处理完毕。常见的2xx状态码包括200 OK、204 No Content和206 Partial Content。
3. 3xx 重定向状态码：表示要对请求进行重定向操作，常见的3xx状态码包括301 Moved Permanently、303 See Other和304 Not Modified。
4. 4xx 客户端错误状态码：表示服务器无法处理请求，常见的4xx状态码包括400 Bad Request、401 Unauthorized、403 Forbidden和404 Not Found。
5. 5xx 服务器错误状态码：表示服务器处理请求时出错，常见的5xx状态码包括500 Internal Server Error和503 Service Unavailable。

以上是HTTP状态码的分类，每一种状态码都有其特定的含义和应用场景。了解和掌握这些状态码可以帮助开发人员更好地理解和处理HTTP请求和响应。

# 4 长链接和短链接区别和举例

长连接和短连接是在网络通信中使用的两种连接策略，它们在连接的管理和使用方式上有显著的区别。

长连接，也称为持久连接，指的是在TCP连接建立后，不管是否使用都保持连接，直到连接的任意一方（通常是客户端）主动断开连接。这种连接方式适用于需要频繁进行数据传输的应用场景，因为连接可以在多次交互中重复使用，减少了建立和断开连接的开销。长连接在数据传输完成后并不会立即关闭，而是会保持一段时间，以便后续的数据传输。这种连接方式可以提高数据传输的效率，但也可能导致资源的浪费，因为连接可能会在不需要的时候仍然保持打开状态。

长连接的一个典型应用是WebSockets，它是一种在单个TCP连接上进行全双工通信的协议，可以在浏览器和服务器之间建立持久的连接，用于实时数据传输和交互。

相比之下，短连接指的是在客户端向服务器发送消息后，服务器回应客户端，然后一次读写操作就完成了，这时候双方任何一个都可以发起关闭连接的操作。短连接通常只会在客户端和服务器间传递一次读写操作，然后立即断开连接。这种连接方式适用于不需要频繁进行数据传输的场景，因为它可以避免不必要的连接开销。短连接在数据传输完成后会立即关闭，不会保持连接状态。

短连接的一个典型应用是HTTP协议，它是一种无状态的协议，每个HTTP请求都需要建立一个新的连接，并在请求完成后立即关闭连接。这种方式虽然会导致一定的连接开销，但对于HTTP这种请求-响应模式的应用来说，是合理且有效的。

总结来说，长连接和短连接各有其优点和适用场景。长连接适用于需要频繁进行数据传输的场景，可以提高效率；而短连接适用于不需要频繁传输数据的场景，可以避免不必要的资源消耗。在实际应用中，需要根据具体的需求和场景来选择合适的连接策略

# 5 网络几层架构以及相关协议

网络层次可划分为五层因特网协议栈和七层因特网协议栈。

五层因特网协议栈包括：应用层、传输层、网络层、链路层和物理层。其中，应用层主要负责处理网络应用，如HTTP、FTP、SMTP等协议；传输层定义了传输数据的协议和端口号，如TCP和UDP；网络层主要负责寻找地址和路由选择，如IP协议；链路层负责将IP数据报封装成合适在物理网络上传输的帧格式并传输，或将从物理网络接收到的帧解封；物理层负责将比特流在结点间传输。

七层因特网协议栈包括：应用层、表示层、会话层、传输层、网络层、数据链路层和物理层。其中，表示层主要进行对接收的数据进行解释、加密与解密、压缩与解压缩等；会话层主要是建立、管理和终止会话；应用层和表示层的功能与五层协议栈类似。

需要注意的是，以上只是常见的两种协议栈，实际上还有其他协议栈和分层模型，例如OSI七层模型等。不同的协议栈和分层模型在网络通信中有各自的特点和应用场景。

# 6 TCP 如何保证传输的可靠性？

TCP（Transmission Control Protocol）通过以下几种机制来保证传输的可靠性：

1. **校验和**：TCP在发送数据时，会对每个数据包进行校验和的计算。接收方在收到数据包后，会对数据包进行同样的校验和计算，然后与发送方的校验和进行比对。如果校验和不一致，接收方会丢弃该数据包，并要求发送方重新发送。这样可以确保数据在传输过程中没有被损坏。
2. **序列号**：TCP会为每个发送的数据包分配一个唯一的序列号。接收方会根据序列号对接收到的数据包进行排序，确保数据的顺序正确。如果接收方发现数据包的序列号不连续，它会要求发送方重新发送缺失的数据包。
3. **确认应答**：接收方在成功接收到数据包后，会向发送方发送一个确认应答（ACK）。发送方会根据确认应答来判断数据包是否成功传输。如果发送方在一定时间内没有收到确认应答，它会认为数据包丢失，并重新发送该数据包。
4. **流量控制**：TCP使用滑动窗口机制进行流量控制，防止发送方发送数据的速度过快，导致接收方无法及时处理。接收方会根据自己的处理能力，告诉发送方一个窗口大小，发送方只能在这个窗口大小内发送数据。当接收方的处理能力下降时，它会减小窗口大小，从而限制发送方的发送速度。
5. **拥塞控制**：当网络发生拥塞时，TCP会采取措施减少数据的发送，以缓解网络拥塞。它会根据网络拥塞的程度，动态调整发送方的发送速度。常见的拥塞控制算法有慢开始、拥塞避免、快重传和快恢复等。

通过这些机制，TCP能够确保数据的可靠传输。即使在网络环境不稳定或网络拥塞的情况下，TCP也能通过重传和拥塞控制等手段，尽可能地保证数据的完整性和顺序性。

# 7 有哪些常见的 RPC 框架

常见的RPC框架主要有以下几种：

1. **gRPC**：由Google开发的高性能、开源的RPC框架，基于Protocol Buffers（protobuf）进行序列化和通信。
2. **Apache Thrift**：由Facebook开发和开源的跨语言RPC框架，提供了跨语言的服务定义和通信能力。
3. **Apache Dubbo**：一款高性能、轻量级的RPC框架，原名为阿里巴巴Dubbo，适用于大规模分布式系统，提供了服务注册、发现、负载均衡等功能。
4. **Apache Axis2**：一款基于Web服务标准的RPC框架，提供了多个模块和扩展，以支持不同的通信协议和数据格式。
5. **Spring Cloud**：基于Spring Boot的微服务框架，提供了一组组件以实现分布式系统的构建和通信，包括服务注册与发现、负载均衡、断路器等。

除此之外，还有如**Twitter的Finagle**、**Akka**等RPC框架也在实际项目中得到应用。这些框架各有特色，可以根据项目的实际需求和技术栈来选择合适的RPC框架。

# 8 TCP和UDP区别与应用举例

TCP（Transmission Control Protocol）和UDP（User Datagram Protocol）是两种主要的网络传输协议，它们在数据传输方式、可靠性、效率等方面存在一些显著的差异。

TCP是一种面向连接的协议，它在开始数据传输之前需要建立连接，这种连接是通过三次握手过程实现的。TCP提供可靠的数据传输服务，它通过确认机制和重传机制来确保数据的完整性和可靠性。如果在传输过程中发生丢包事件，TCP会重传丢失的分组，因此，TCP保证发送的分组一定能到达接收方。由于TCP的这些特性，它适用于对数据完整性要求较高的应用场景，如文件传输和网页浏览。

相比之下，UDP是一种无连接的协议，它不需要建立连接就可以进行数据传输，因此不会引入建立连接的时延。UDP尽最大努力交付数据，即不保证可靠交付。UDP在传输数据前不需要建立连接，没有繁琐的握手过程，没有复杂的拥塞控制算法和重传机制，因此，UDP相对于TCP具有较高的效率。UDP适用于实时性要求较高的应用，如音视频传输和在线游戏。

至于应用举例，TCP通常用于需要确保数据完整性和可靠性的场景，如网页浏览和文件传输。例如，当你在浏览器中访问一个网页时，浏览器和服务器之间会建立TCP连接，以确保网页数据的完整性和顺序性。而UDP则常用于实时性要求较高的场景，如在线游戏和音视频传输。例如，在在线游戏中，玩家的操作和游戏状态需要实时传输给其他玩家，这时就可以使用UDP协议，因为它可以提供更快的传输速度和更低的延迟。

总的来说，TCP和UDP各有其优点和适用场景，选择哪种协议取决于具体的应用需求和网络环境。

TCP和UDP是两种主要的传输层协议，它们在数据通信中起着至关重要的作用。以下是它们之间的主要区别：

1. 连接性：TCP（Transmission Control Protocol）是面向连接的协议，这意味着在数据传输之前，发送方和接收方之间需要建立连接。这种连接是通过三次握手过程实现的，它确保了双方都已准备好进行数据交换。而UDP（User Datagram Protocol）是无连接的协议，它不需要建立连接，而是直接发送数据。
2. 可靠性：TCP是一种可靠的传输协议，它提供了数据传输的错误控制、数据顺序和数据完整性。它通过重传机制确保数据被正确接收。而UDP则是一种不可靠的协议，它不保证数据传输的正确性，也不提供重传机制。
3. 传输方式：TCP是基于字节流的传输方式，它将数据分割成字节流，然后通过网络发送。而UDP是基于数据报文的传输方式，它将数据封装在报文中，然后发送。
4. 应用场景：TCP适用于需要可靠传输的应用场景，如文件传输、网页浏览等。而UDP适用于对实时性要求较高，但对数据可靠性要求较低的应用场景，如音频、视频流传输等。

举例来说，当你使用网页浏览器浏览网页时，浏览器和服务器之间使用的是TCP协议进行数据传输，因为网页数据需要被正确、完整地传输到浏览器端。而当你使用在线视频应用观看视频时，视频流通常使用UDP协议进行传输，因为视频流对实时性要求较高，而UDP协议能够更好地满足这一需求。

总之，TCP和UDP各有其优缺点，适用于不同的应用场景。在选择使用哪种协议时，需要根据具体的应用需求来决定。

# RPC 的原理是什么?

RPC（Remote Procedure Call）即远程过程调用，是一种通过网络从远程计算机程序上请求服务，而不需要了解底层网络技术的思想。它的主要原理涉及客户端通过网络调用服务端的方法，实现跨网络的方法调用。

RPC的基本架构通常包含四个核心组件：Client（客户端）、Server（服务端）、Client Stub（客户端存根）以及Server Stub（服务端存根）。客户端是服务调用方，服务端是服务提供方。客户端存根存放服务端的地址消息，负责将客户端的请求参数打包成网络消息，然后通过网络发送给服务提供方。服务端存根接收客户端发送的消息，再将客户端请求参数打包成网络消息，然后通过网络远程发送给服务方。这样既实现了客户端和服务端之间的解耦，也使得RPC接口可以在多个项目中重复利用。

RPC的完整过程可以分为以下几个步骤：

1. 客户端发起方法调用：客户端通过网络向服务端发起方法调用请求，请求通常包括要调用的方法名、参数等信息。
2. 网络传输：客户端将方法调用请求通过网络发送给服务端，网络传输可以使用各种协议，如HTTP、TCP/IP等。
3. 服务端接收请求：服务端接收来自客户端的方法调用请求。
4. 方法执行：服务端根据请求中的方法名和参数等信息，找到相应的方法并执行。
5. 返回结果：服务端将方法执行的结果返回给客户端。
6. 客户端接收结果：客户端接收到服务端返回的方法执行结果。

此外，RPC服务通常还需要服务注册中心的参与，负责将本地服务发布成远程服务，管理远程服务，并提供给服务消费者使用。服务注册中心还可以实现负载均衡和故障切换。

# rpc和http原理和区别

RPC（Remote Procedure Call，远程过程调用）和HTTP（HyperText Transfer Protocol，超文本传输协议）是两种不同的通信协议，它们在原理和使用上存在一些区别。

**RPC的原理和特点：**

RPC是一种允许程序在不同的计算机或进程上调用远程过程或函数的协议。它基于网络协议（如TCP/IP）进行通信，使得客户端能够像调用本地程序一样调用远程服务器上的程序。RPC的主要特点包括：

- 透明性：客户端调用远程过程时，无需了解底层的网络通信细节，使得调用过程更加简单和透明。
- 同步或异步通信：RPC支持同步和异步两种通信方式。同步通信中，客户端等待服务器返回结果后才能继续执行；而异步通信中，客户端可以在不等待服务器响应的情况下继续执行其他任务。
- 语言无关性：RPC协议通常与特定的编程语言无关，这使得不同语言编写的客户端和服务器之间可以进行通信。

**HTTP的原理和特点：**

HTTP是一种应用层协议，主要用于在Web应用中传输超文本数据（如HTML页面）。它基于TCP/IP协议进行通信，并使用请求-响应模式进行数据传输。HTTP的主要特点包括：



# HTTP 基于 TCP 还是 UDP？

HTTP（Hypertext Transfer Protocol）是基于TCP（Transmission Control Protocol）的，而不是UDP（User Datagram Protocol）。这是因为HTTP协议需要可靠的数据传输，而TCP是一种面向连接的、可靠的传输层协议，它提供了错误控制、数据顺序和数据完整性等机制，能够确保数据被正确、完整地传输。相比之下，UDP是一种无连接的、不可靠的协议，它不能保证数据传输的正确性和完整性，因此不适合用于HTTP协议。

在HTTP协议中，当浏览器发送请求时，它需要与服务器建立TCP连接。一旦连接建立成功，浏览器就可以通过TCP连接发送HTTP请求，并等待服务器的响应。服务器在收到请求后，会处理请求并返回HTTP响应，然后通过TCP连接将响应发送回浏览器。这个过程需要保证数据的可靠性、顺序性和完整性，因此HTTP协议选择使用TCP作为传输层协议。

需要注意的是，虽然HTTP/1.1和HTTP/2都是基于TCP传输协议的，但是HTTP/3将会基于UDP协议进行传输。这是因为HTTP/3引入了QUIC（Quick UDP Internet Connections）协议，它是一种基于UDP的协议，具有更好的连接建立速度和网络性能。不过，即使HTTP/3使用了UDP协议，它仍然需要保证数据传输的可靠性、顺序性和完整性，因此在QUIC协议中也包含了一些类似TCP的机制来实现这些功能。

# 什么是 IP 地址？IP 寻址如何工作？

IP地址（Internet Protocol Address）是指互联网协议地址，是分配给网络设备上用于标识其在网络中的唯一地址。IP地址由一串数字组成，通常分为四段，每段数字的范围是0-255，各段之间用小数点隔开。例如，192.168.1.1就是一个常见的IP地址。

IP寻址是指在网络中根据IP地址找到目标设备的过程。当一台设备想要与另一台设备进行通信时，它会将目标设备的IP地址作为目的地址，然后将数据发送到网络上。网络设备（如路由器、交换机等）会根据IP地址中的网络部分（即网络前缀）将数据转发到目标设备所在的网络段。然后，目标设备所在的网络段上的设备会根据IP地址中的主机部分（即主机号）将数据发送到目标设备。

具体来说，IP寻址的过程包括以下几个步骤：

1. 源设备将目标设备的IP地址作为目的地址，并将数据发送到本地网络中。
2. 本地网络中的路由器或交换机接收到数据后，会检查数据包的头部信息，包括目的IP地址。
3. 路由器或交换机根据目的IP地址中的网络部分，确定目标设备所在的网络段，并将数据转发到该网络段上。
4. 目标设备所在的网络段上的设备接收到数据后，会根据目的IP地址中的主机部分，将数据发送到目标设备。
5. 目标设备接收到数据后，会检查数据包的头部信息，确认数据是发送给自己的，并进行相应的处理。

需要注意的是，IP寻址只能找到目标设备所在的网络段，而无法直接找到目标设备。因此，在局域网中，通常需要使用其他协议（如ARP协议）来根据IP地址找到目标设备的MAC地址，从而完成数据的最终传输。

# 为什么连接的时候是三次握手，关闭的时候却是四次握手

TCP建立连接时需要进行三次握手，而关闭连接时需要进行四次握手，主要原因如下：

1. 在建立连接时，需要进行三次握手才能确保两台机器都已经准备好进行数据传输，并且具备发送和接收数据的能力。此外，三次握手还可以同步双方的起始序列号，以确保数据的准确传输。
2. 在关闭连接时，需要进行四次握手是因为TCP连接是全双工的，因此每个方向都需要单独关闭。此外，TCP协议为了确保双方都已经完成了数据的发送和接收，需要在发送完最后一个数据包后发送一个FIN报文，表示关闭连接的请求。在收到这个请求后，对方需要回复一个ACK报文，确认收到请求并同意关闭连接。因此，四次握手可以确保双方都同意关闭连接，并且已经完成了数据的发送和接收。

需要注意的是，在TCP关闭连接的过程中，四次握手并不是必须的。如果客户端在发送完数据后立即关闭连接，就不需要等待服务器的回复。但是，如果客户端想要确保服务器已经收到了数据并完成了处理，就需要等待服务器的回复。因此，四次握手是为了确保双方都已经完成了数据的发送和接收并同意关闭连接的一种机制。

# TCP报头文结构

TCP报头文结构包括以下部分：

源端口号和目的端口号：各占16位，标识发送和接收数据的应用程序。 序号：占32位，标识TCP报文段中的第一个字节。 确认号：占32位，用于确认接收到的字节序号。 头部长度：占4位，标识TCP头部长度。 标志位：包括URG、ACK、PSH、RST、SYN和FIN等标志，用于标识TCP报文段的类型和功能。 窗口大小：占16位，用于流量控制，表示接收窗口的大小。 校验和：占16位，用于检测数据传输过程中的错误。 紧急指针：占16位，用于标识紧急数据的末尾位置。 TCP选项：可变长度的可选信息，用于支持各种选项功能，如窗口缩放、时间戳等。 这些字段按照TCP报文段的顺序排列，并按照二进制进行传输。TCP报头文结构保证了可靠、有序和错误校验的数据传输服务。其中，TCP选项部分是可变长度的可选信息，以实现对协议的扩展。在实际的网络传输中，TCP头部最大为60字节（不包含选项），而IP头部固定为20字节